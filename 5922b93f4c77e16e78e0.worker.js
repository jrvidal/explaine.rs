!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){let n;!function(){const e={};let t,r=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});r.decode();let o=null;function s(){return null!==o&&o.buffer===t.memory.buffer||(o=new Uint8Array(t.memory.buffer)),o}function i(e,t){return r.decode(s().subarray(e,e+t))}const a=new Array(32).fill(void 0);a.push(void 0,null,!0,!1);let l=a.length;let c=null;function u(){return null!==c&&c.buffer===t.memory.buffer||(c=new Int32Array(t.memory.buffer)),c}let p=null;function _(){return null!==p&&p.buffer===t.memory.buffer||(p=new Uint32Array(t.memory.buffer)),p}function f(e){const t=function(e){return a[e]}(e);return function(e){e<36||(a[e]=l,l=e)}(e),t}let d=0,b=new TextEncoder("utf-8");const w="function"==typeof b.encodeInto?function(e,t){return b.encodeInto(e,t)}:function(e,t){const n=b.encode(e);return t.set(n),{read:e.length,written:n.length}};class g{static __wrap(e){const t=Object.create(g.prototype);return t.ptr=e,t}free(){const e=this.ptr;this.ptr=0,t.__wbg_explanation_free(e)}get start_line(){return t.__wbg_get_explanation_start_line(this.ptr)>>>0}set start_line(e){t.__wbg_set_explanation_start_line(this.ptr,e)}get start_column(){return t.__wbg_get_explanation_start_column(this.ptr)>>>0}set start_column(e){t.__wbg_set_explanation_start_column(this.ptr,e)}get end_line(){return t.__wbg_get_explanation_end_line(this.ptr)>>>0}set end_line(e){t.__wbg_set_explanation_end_line(this.ptr,e)}get end_column(){return t.__wbg_get_explanation_end_column(this.ptr)>>>0}set end_column(e){t.__wbg_set_explanation_end_column(this.ptr,e)}elaborate(){return f(t.explanation_elaborate(this.ptr))}title(){return f(t.explanation_title(this.ptr))}keyword(){return f(t.explanation_keyword(this.ptr))}book(){return f(t.explanation_book(this.ptr))}std(){return f(t.explanation_std(this.ptr))}}e.Explanation=g;class m{static __wrap(e){const t=Object.create(m.prototype);return t.ptr=e,t}free(){const e=this.ptr;this.ptr=0,t.__wbg_session_free(e)}static new(e){var n=function(e,t,n){if(void 0===n){const n=b.encode(e),r=t(n.length);return s().subarray(r,r+n.length).set(n),d=n.length,r}let r=e.length,o=t(r);const i=s();let a=0;for(;a<r;a++){const t=e.charCodeAt(a);if(t>127)break;i[o+a]=t}if(a!==r){0!==a&&(e=e.slice(a)),o=n(o,r,r=a+3*e.length);const t=s().subarray(o+a,o+r);a+=w(e,t).written}return d=a,o}(e,t.__wbindgen_malloc,t.__wbindgen_realloc),r=d,o=t.session_new(n,r);return h.__wrap(o)}explore(e){try{var n=function(e,t){const n=t(4*e.length);return _().set(e,n/4),d=e.length,n}(e,t.__wbindgen_malloc),r=d;return t.session_explore(this.ptr,n,r)>>>0}finally{e.set(_().subarray(n/4,n/4+r)),t.__wbindgen_free(n,4*r)}}explain(e,n){var r=t.session_explain(this.ptr,e,n);return 0===r?void 0:g.__wrap(r)}}e.Session=m;class h{static __wrap(e){const t=Object.create(h.prototype);return t.ptr=e,t}free(){const e=this.ptr;this.ptr=0,t.__wbg_sessionresult_free(e)}session(){var e=this.ptr;this.ptr=0;var n=t.sessionresult_session(e);return 0===n?void 0:m.__wrap(n)}error_location(){t.sessionresult_error_location(8,this.ptr);var e=u()[2],n=u()[3];let r;var o,s;return 0!==e&&(r=(o=e,s=n,_().subarray(o/4,o/4+s)).slice(),t.__wbindgen_free(e,4*n)),r}error_message(){return f(t.sessionresult_error_message(this.ptr))}is_block(){return 0!==t.sessionresult_is_block(this.ptr)}}e.SessionResult=h,n=Object.assign((async function e(n){if(void 0===n){let e;e="undefined"==typeof document?location.href:document.currentScript.src,n=e.replace(/\.js$/,"_bg.wasm")}const r={wbg:{}};r.wbg.__wbindgen_string_new=function(e,t){return function(e){l===a.length&&a.push(a.length+1);const t=l;return l=a[t],a[t]=e,t}(i(e,t))},r.wbg.__wbindgen_throw=function(e,t){throw new Error(i(e,t))},("string"==typeof n||"function"==typeof Request&&n instanceof Request||"function"==typeof URL&&n instanceof URL)&&(n=fetch(n));const{instance:o,module:s}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await n,r);return t=o.exports,e.__wbindgen_wasm_module=s,t}),e)}(),e.exports=n},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r);var s=n.p+"8ffcf092dcd5cc4ed7becc700b0a99bf.wasm";const i="https://tzl3kczlk5.execute-api.us-east-1.amazonaws.com/default/explainer",a=()=>{},l=(e,t)=>{const n=t&&t.error||t,r=JSON.stringify({kind:e,nativeError:n instanceof Error,line:t&&t.lineno,column:t&&t.colno,message:t&&t.message||n&&n.message,filename:t&&t.filename,stack:n&&n.stack,raw:t});fetch(i,{method:"POST",body:r})};let c;self.addEventListener("error",e=>{l(null!=typeof window?"window.onerror":"self.onerror",e)}),a("workerMain");let u=!0;const p={source:null,session:null,explanation:null,exploration:null};function _(e){o()(e||s).then(()=>{c=o.a,postMessage({type:"ready",compiledModule:o.a.__wbindgen_wasm_module})}).catch(e=>l("wasm_bindgen",e))}function f(e){p.explanation&&(p.explanation.free(),p.explanation=null),p.explanation=p.session&&p.session.explain(e.line+1,e.ch)}function d(e){return null!=e?{start:{line:e.start_line-1,ch:e.start_column},end:{line:e.end_line-1,ch:e.end_column}}:null}self.onmessage=e=>{const{data:t}=e;switch(a(u?"Main":"Secondary","worker received",t.type,t),t.type){case"main-load":return void _(null);case"secondary-load":return u=!1,void _(t.compiledModule);case"stop-compilation":return void(!u&&p.session&&(p.session.free(),p.session=null));case"compile":return void function(e){p.session&&(p.session.free(),p.session=null);const t=c.Session.new(e),n=t.error_message(),r=t.error_location(),o=null!=n?{msg:n,start:{line:r[0]-1,ch:r[1]},end:{line:r[2]-1,ch:r[3]},isBlock:t.is_block()}:null;p.session=t.session(),p.error=o,u?postMessage({type:null!=p.session?"compiled":"compilation-error",error:p.error}):function e(t,n=!1){if(t!=p.session||null==p.session)return;n&&(p.exploration={buffer:new self.Uint32Array(2e3),result:[],byStart:new Map,start:Date.now()});const{buffer:r,result:o,byStart:s}=p.exploration,i=p.session.explore(r);for(let e=0;e<i;e++){const t={start:{line:r[4*e]-1,ch:r[4*e+1]},end:{line:r[4*e+2]-1,ch:r[4*e+3]}};s.has(t.start.line)||s.set(t.start.line,[]),s.get(t.start.line).some(e=>e.start.line===t.start.line&&e.start.ch===t.start.ch&&e.end.line===t.end.line&&e.end.ch===t.end.ch)||(s.get(t.start.line).push(t),o.push(t))}if(0===i)return a("Exploration finished..."),void postMessage({type:"exploration",exploration:p.exploration.result});b(()=>e(t))}(p.session,!0)}(t.source);case"explain":return void(u&&function(e){f(e),postMessage({type:"explanation",location:d(p.explanation)})}(t.location));case"elaborate":return void(u&&function(e){f(e),postMessage({type:"elaboration",location:d(p.explanation),elaboration:p.explanation&&p.explanation.elaborate(),title:p.explanation&&p.explanation.title(),book:p.explanation&&p.explanation.book(),keyword:p.explanation&&p.explanation.keyword(),std:p.explanation&&p.explanation.std()})}(t.location));default:0,console.error("Unexpected message in worker",t)}};const b=(()=>{let e=new Map,t=0,n=new MessageChannel;return n.port1.onmessage=t=>{let n=t.data,r=e.get(n);e.delete(n),r()},r=>{let o=t;e.set(o,r),t++,n.port2.postMessage(o)}})()}]);